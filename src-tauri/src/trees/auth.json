{
  "root_node_id": "auth-root",
  "nodes": {
    "auth-root": {
      "id": "auth-root",
      "type": "question",
      "title": "What type of authentication issue?",
      "content": null,
      "options": [
        { "label": "Can't log in at all", "next_node_id": "auth-login" },
        { "label": "MFA not working", "next_node_id": "auth-mfa" },
        { "label": "SSO redirect loop", "next_node_id": "auth-sso" }
      ]
    },
    "auth-login": {
      "id": "auth-login",
      "type": "question",
      "title": "Login failure details",
      "content": "What happens when you try to log in?",
      "options": [
        { "label": "Invalid password error", "next_node_id": "auth-password" },
        { "label": "Account locked message", "next_node_id": "auth-locked" },
        { "label": "Username not found", "next_node_id": "auth-username" }
      ]
    },
    "auth-password": {
      "id": "auth-password",
      "type": "action",
      "title": "Check password issues",
      "content": "1. Verify caps lock is off\n2. Check if password expired (90-day policy)\n3. Try password reset via self-service portal\n4. If still failing, check AD account status",
      "options": [
        { "label": "Password reset worked", "next_node_id": "auth-resolved" },
        { "label": "Still can't log in", "next_node_id": "auth-escalate" }
      ]
    },
    "auth-locked": {
      "id": "auth-locked",
      "type": "action",
      "title": "Account locked",
      "content": "Account lockout typically occurs after 5 failed attempts.\n\n1. Wait 15 minutes for auto-unlock\n2. Or contact IT admin to manually unlock\n3. Check for password spraying attacks if multiple users affected",
      "options": [
        { "label": "Account unlocked", "next_node_id": "auth-resolved" },
        { "label": "Still locked", "next_node_id": "auth-escalate" }
      ]
    },
    "auth-username": {
      "id": "auth-username",
      "type": "action",
      "title": "Username not found",
      "content": "1. Verify the exact username format (email vs UPN vs SAMAccountName)\n2. Check for typos in the username\n3. Verify user account exists in Active Directory\n4. Check if account was recently created or migrated",
      "options": [
        { "label": "Found correct username", "next_node_id": "auth-resolved" },
        { "label": "Account doesn't exist", "next_node_id": "auth-escalate" }
      ]
    },
    "auth-mfa": {
      "id": "auth-mfa",
      "type": "question",
      "title": "MFA method",
      "content": "Which MFA method is failing?",
      "options": [
        { "label": "Authenticator app", "next_node_id": "auth-mfa-app" },
        { "label": "SMS code", "next_node_id": "auth-mfa-sms" },
        { "label": "Hardware token", "next_node_id": "auth-mfa-token" }
      ]
    },
    "auth-mfa-app": {
      "id": "auth-mfa-app",
      "type": "action",
      "title": "Authenticator app issues",
      "content": "1. Verify phone time is set to automatic\n2. Check app has correct account added\n3. Try removing and re-adding account\n4. If using Microsoft Authenticator, try push notification instead of code",
      "options": [
        { "label": "Fixed", "next_node_id": "auth-resolved" },
        { "label": "Still failing", "next_node_id": "auth-escalate" }
      ]
    },
    "auth-mfa-sms": {
      "id": "auth-mfa-sms",
      "type": "action",
      "title": "SMS MFA issues",
      "content": "1. Verify phone number is correct in account settings\n2. Check phone has cellular signal\n3. Try requesting code again\n4. Check if SMS is blocked by carrier",
      "options": [
        { "label": "Receiving codes now", "next_node_id": "auth-resolved" },
        { "label": "Still not receiving", "next_node_id": "auth-escalate" }
      ]
    },
    "auth-mfa-token": {
      "id": "auth-mfa-token",
      "type": "action",
      "title": "Hardware token issues",
      "content": "1. Check token battery (if applicable)\n2. Verify token is synced with server\n3. Check for clock drift on token\n4. Try re-seeding token if possible",
      "options": [
        { "label": "Token working", "next_node_id": "auth-resolved" },
        { "label": "Need replacement", "next_node_id": "auth-escalate" }
      ]
    },
    "auth-sso": {
      "id": "auth-sso",
      "type": "action",
      "title": "SSO redirect loop",
      "content": "1. Clear browser cookies and cache\n2. Try incognito/private window\n3. Check if issue is browser-specific\n4. Verify SSO IdP status page for outages",
      "options": [
        { "label": "Resolved", "next_node_id": "auth-resolved" },
        { "label": "Still looping", "next_node_id": "auth-escalate" }
      ]
    },
    "auth-resolved": {
      "id": "auth-resolved",
      "type": "terminal",
      "title": "Issue resolved",
      "content": "Authentication issue has been resolved. Document the solution in the ticket."
    },
    "auth-escalate": {
      "id": "auth-escalate",
      "type": "terminal",
      "title": "Escalate to Identity Team",
      "content": "Escalate to Identity & Access Management team with:\n- User's UPN/email\n- Exact error message or screenshot\n- Steps already attempted\n- Time of last successful login"
    }
  }
}
